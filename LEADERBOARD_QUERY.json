[
  {
    "name": "Audit Performance",
    "query": "SELECT id, ROUND(total, 2) AS Best_Score, ROUND(clarity, 2) AS Clarity, ROUND(logic, 2) AS Logic, ROUND(align, 2) AS Align, ROUND(flow, 2) AS Flow FROM (SELECT id, total, clarity, logic, align, flow, ROW_NUMBER() OVER (PARTITION BY id ORDER BY total DESC) as rn FROM (SELECT t.participants.agent AS id, AVG(r.totalScore) AS total, AVG(r.clarityScore) AS clarity, AVG(r.logicScore) AS logic, AVG(r.internalAlignment) AS align, AVG(r.narrativeFlow) AS flow FROM results t CROSS JOIN UNNEST(t.results) AS _(r) GROUP BY id, t.participants.run_id)) WHERE rn = 1 ORDER BY Best_Score DESC;"
  }
]